{
  "name": "spfx-local-workbench",
  "displayName": "SPFx Local Workbench",
  "description": "A local workbench for testing SharePoint Framework (SPFx) web parts without deploying to SharePoint",
  "version": "0.0.1",
  "publisher": "BeauCameron",
  "author": {
    "name": "Beau Cameron",
    "url": "https://github.com/bcameron1231"
  },
  "contributors": [
    {
      "name": "Chris Kent",
      "url": "https://github.com/thechriskent"
    },
    {
      "name": "Hugo Bernier",
      "url": "https://github.com/hugoabernier"
    }
  ],
  "icon": "media/icon.png",
  "repository": {
    "type": "git",
    "url": "https://github.com/bcameron1231/SPFx-LocalWorkbench"
  },
  "engines": {
    "vscode": "^1.100.0",
    "node": "22.x"
  },
  "categories": [
    "Other",
    "Debuggers"
  ],
  "keywords": [
    "SPFx",
    "SharePoint",
    "SharePoint Framework",
    "Web Parts",
    "Workbench",
    "Local Development"
  ],
  "activationEvents": [
    "workspaceContains:**/config/package-solution.json",
    "onWebviewPanel:spfxLocalWorkbench"
  ],
  "main": "./dist/extension.js",
  "contributes": {
    "icons": {
      "fluentui-testbeaker": {
        "description": "Test Beaker",
        "default": {
          "fontPath": "media/icons.woff",
          "fontCharacter": "\\F3A5"
        }
      },
      "fluentui-testbeakersolid": {
        "description": "Test Beaker Solid",
        "default": {
          "fontPath": "media/icons.woff",
          "fontCharacter": "\\F3A6"
        }
      },
      "fluentui-teststep": {
        "description": "Test Step",
        "default": {
          "fontPath": "media/icons.woff",
          "fontCharacter": "\\F3AC"
        }
       },
      "fluentui-localelanguage": {
        "description": "Locale Language",
        "default": {
          "fontPath": "media/icons.woff",
          "fontCharacter": "\\F2B7"
        }
      },
      "fluentui-sync": {
        "description": "Sync",
        "default": {
          "fontPath": "media/icons.woff",
          "fontCharacter": "\\E895"
        }
      },
      "fluentui-developertools": {
        "description": "Developer Tools",
        "default": {
          "fontPath": "media/icons.woff",
          "fontCharacter": "\\EC7A"
        }
      },
      "fluentui-broom": {
        "description": "Broom",
        "default": {
          "fontPath": "media/icons.woff",
          "fontCharacter": "\\EA99"
        }
      }
    },
    "commands": [
      {
        "command": "spfx-local-workbench.openWorkbench",
        "title": "Open Local Workbench",
        "category": "SPFx",
        "icon": "$(fluentui-testbeaker)"
      },
      {
        "command": "spfx-local-workbench.startServe",
        "title": "Start Serve & Open Workbench",
        "category": "SPFx",
        "icon": "$(fluentui-testbeakersolid)"
      },
      {
        "command": "spfx-local-workbench.detectWebParts",
        "title": "Refresh Web Parts",
        "category": "SPFx",
        "icon": "$(fluentui-sync)"
      },
      {
        "command": "spfx-local-workbench.openDevTools",
        "title": "Open Developer Tools",
        "category": "SPFx",
        "icon": "$(fluentui-developertools)"
      },
      {
        "command": "spfx-local-workbench.openStorybook",
        "title": "Open Storybook",
        "category": "SPFx",
        "icon": "$(fluentui-teststep)"
      },
      {
        "command": "spfx-local-workbench.generateStories",
        "title": "Generate Storybook Stories",
        "category": "SPFx",
        "icon": "$(file-code)"
      },
      {
        "command": "spfx-local-workbench.cleanStorybook",
        "title": "Clean Storybook",
        "category": "SPFx",
        "icon": "$(fluentui-broom)"
      }
    ],
    "menus": {
      "editor/title": [
        {
          "command": "spfx-local-workbench.openWorkbench",
          "when": "resourceFilename =~ /\\.manifest\\.json$/",
          "group": "navigation"
        },
        {
          "command": "spfx-local-workbench.detectWebParts",
          "when": "spfxLocalWorkbench.isWorkbench",
          "group": "navigation"
        },
        {
          "command": "spfx-local-workbench.openDevTools",
          "when": "spfxLocalWorkbench.isWorkbench",
          "group": "navigation"
        }
      ],
      "webview/title": [
        {
          "command": "spfx-local-workbench.detectWebParts",
          "when": "webviewType == spfxLocalWorkbench",
          "group": "navigation"
        },
        {
          "command": "spfx-local-workbench.openDevTools",
          "when": "webviewType == spfxLocalWorkbench",
          "group": "navigation"
        }
      ]
    },
    "configuration": [
      {
        "title": "General",
        "properties": {
          "spfxLocalWorkbench.serveUrl": {
            "type": "string",
            "default": "https://localhost:4321",
            "description": "The URL where the SPFx serve is running"
          },
          "spfxLocalWorkbench.autoOpenWorkbench": {
            "type": "boolean",
            "default": false,
            "description": "Automatically open the workbench when starting serve"
          },
          "spfxLocalWorkbench.serveCommand": {
            "type": "string",
            "default": "heft start --clean --nobrowser",
            "markdownDescription": "The command to run when starting the SPFx serve from the extension. Common options:\n- `heft start --clean --nobrowser`, `heft start --clean --nobrowser --locales=fr-fr`, `npm run start`"
          },
          "spfxLocalWorkbench.statusBarAction": {
            "type": "string",
            "enum": [
              "openWorkbench",
              "startServe",
              "openStorybook"
            ],
            "markdownEnumDescriptions": [
              "$(fluentui-testbeaker) Open the Local Workbench panel",
              "$(fluentui-testbeakersolid) Start serve and open the Local Workbench panel",
              "$(fluentui-teststep) Open Storybook for visual component testing"
            ],
            "default": "openWorkbench",
            "description": "Action to perform when clicking the SPFx status bar item"
          }
        }
      },
      {
        "title": "Theme",
        "properties": {
          "spfxLocalWorkbench.theme.current": {
            "type": "string",
            "enum": [
              "teal",
              "blue",
              "orange",
              "red",
              "purple",
              "green",
              "periwinkle",
              "cobalt",
              "dark-teal",
              "dark-blue",
              "custom"
            ],
            "enumDescriptions": [
              "Teal - Microsoft's teal theme",
              "Blue - Microsoft's blue theme",
              "Orange - Microsoft's orange theme",
              "Red - Microsoft's red theme",
              "Purple - Microsoft's purple theme",
              "Green - Microsoft's green theme",
              "Periwinkle - Microsoft's periwinkle theme",
              "Cobalt - Microsoft's cobalt theme",
              "Dark Teal - Microsoft's dark teal theme",
              "Dark Blue - Microsoft's dark blue theme",
              "Custom - Use a custom theme ID"
            ],
            "default": "teal",
            "description": "Select the theme for the workbench"
          },
          "spfxLocalWorkbench.theme.customId": {
            "type": "string",
            "default": "",
            "markdownDescription": "Custom theme ID when `#spfxLocalWorkbench.theme.current#` is set to `custom`. Must match an ID defined in `#spfxLocalWorkbench.theme.custom#`"
          },
          "spfxLocalWorkbench.theme.custom": {
            "type": "array",
            "default": [],
            "markdownDescription": "Custom themes in addition to the default Microsoft themes. Each theme should have `id`, `name`, and `palette` properties",
            "items": {
              "type": "object",
              "required": ["id", "name", "palette"],
              "properties": {
                "id": {
                  "type": "string",
                  "description": "Unique identifier for the theme"
                },
                "name": {
                  "type": "string",
                  "description": "Display name for the theme"
                },
                "palette": {
                  "type": "object",
                  "description": "Fluent UI theme palette with color values",
                  "required": [
                    "themePrimary",
                    "themeLighterAlt",
                    "themeLighter",
                    "themeLight",
                    "themeTertiary",
                    "themeSecondary",
                    "themeDarkAlt",
                    "themeDark",
                    "themeDarker",
                    "neutralLighterAlt",
                    "neutralLighter",
                    "neutralLight",
                    "neutralQuaternaryAlt",
                    "neutralQuaternary",
                    "neutralTertiaryAlt",
                    "neutralTertiary",
                    "neutralSecondary",
                    "neutralPrimaryAlt",
                    "neutralPrimary",
                    "neutralDark",
                    "black",
                    "white"
                  ],
                  "additionalProperties": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      },
      {
        "title": "Context",
        "properties": {
          "spfxLocalWorkbench.context.pageContext": {
            "type": "object",
            "default": {
              "site": {
                "absoluteUrl": "https://contoso.sharepoint.com/sites/devsite",
                "id": "00000000-0000-4000-b000-666666666666"
              },
              "web": {
                "absoluteUrl": "https://contoso.sharepoint.com/sites/devsite",
                "title": "Local Workbench",
                "description": "Local development workbench for SPFx",
                "templateName": "STS#3",
                "id": "00000000-0000-4000-b000-777777777777"
              },
              "user": {
                "displayName": "Local Workbench User",
                "email": "user@contoso.onmicrosoft.com",
                "loginName": "i:0#.f|membership|user@contoso.onmicrosoft.com",
                "isAnonymousGuestUser": false
              },
              "cultureInfo": {
                "currentCultureName": "en-US"
              },
              "isNoScriptEnabled": false,
              "isSPO": true
            },
            "markdownDescription": "SharePoint page context for the mock environment (mirrors SPFx `context.pageContext` structure). Additional properties can be added as needed",
            "properties": {
              "site": {
                "type": "object",
                "description": "Site-level context information",
                "properties": {
                  "absoluteUrl": {
                    "type": "string",
                    "description": "Absolute URL of the site collection"
                  }
                },
                "additionalProperties": true
              },
              "web": {
                "type": "object",
                "description": "Web-level context information",
                "properties": {
                  "absoluteUrl": {
                    "type": "string",
                    "description": "Absolute URL of the web"
                  },
                  "title": {
                    "type": "string",
                    "description": "Title of the web"
                  },
                  "description": {
                    "type": "string",
                    "description": "Description of the web"
                  },
                  "templateName": {
                    "type": "string",
                    "description": "Web template name (e.g., STS#3, SITEPAGEPUBLISHING#0)"
                  }
                },
                "additionalProperties": true
              },
              "user": {
                "type": "object",
                "description": "Current user information",
                "properties": {
                  "displayName": {
                    "type": "string",
                    "description": "Display name of the user"
                  },
                  "email": {
                    "type": "string",
                    "description": "Email address of the user"
                  },
                  "loginName": {
                    "type": "string",
                    "description": "Login name of the user"
                  },
                  "isAnonymousGuestUser": {
                    "type": "boolean",
                    "description": "Whether the user is an anonymous guest"
                  }
                },
                "additionalProperties": true
              },
              "cultureInfo": {
                "type": "object",
                "description": "Culture/locale information",
                "properties": {
                  "currentCultureName": {
                    "type": "string",
                    "description": "Current culture code (e.g., en-US, de-DE, fr-FR)"
                  }
                },
                "additionalProperties": true
              },
              "isNoScriptEnabled": {
                "type": "boolean",
                "description": "Whether NoScript is enabled on the site"
              },
              "isSPO": {
                "type": "boolean",
                "description": "Whether this is SharePoint Online (vs. on-premises)"
              }
            },
            "additionalProperties": true
          }
        }
      },
      {
        "title": "Storybook",
        "properties": {
          "spfxLocalWorkbench.storybook.port": {
            "type": "number",
            "default": 6006,
            "description": "Port for the Storybook dev server"
          },
          "spfxLocalWorkbench.storybook.autoGenerate": {
            "type": "boolean",
            "default": true,
            "description": "Automatically generate stories from SPFx component manifests"
          },
          "spfxLocalWorkbench.storybook.storiesPattern": {
            "type": "string",
            "default": "src/**/*.stories.ts",
            "description": "Glob pattern for discovering custom story files in the SPFx project"
          },
          "spfxLocalWorkbench.storybook.generateLocaleStories": {
            "type": "boolean",
            "default": true,
            "description": "Automatically generate story variants for each supported locale"
          }
        }
      }
    ]
  },
  "scripts": {
    "vscode:prepublish": "npm run package",
    "compile": "npm run packages:build && npm run check-types && npm run lint && npm run generate:css-types && npm-run-all compile:*",
    "compile:extension": "node esbuild.js",
    "compile:webview": "node webview/esbuild.config.js",
    "generate:css-types": "tcm webview/src",
    "watch": "npm-run-all -p watch:*",
    "watch:esbuild": "node esbuild.js --watch",
    "watch:tsc": "tsc --noEmit --watch --project tsconfig.json",
    "watch:webview": "node webview/esbuild.config.js --watch",
    "watch:css-types": "tcm webview/src --watch",
    "package": "npm run packages:build && npm run check-types && npm run lint && npm-run-all package:*",
    "package:extension": "node esbuild.js --production",
    "package:webview": "node webview/esbuild.config.js --production",
    "check-types": "tsc --noEmit",
    "lint": "eslint src",
    "generate:icons": "node scripts/generateIcons.js",
    "packages:build": "npm run packages:build:shared && npm run packages:build:addon",
    "packages:build:shared": "cd packages/shared && npm run build",
    "packages:build:addon": "cd packages/storybook-addon-spfx && npm run build",
    "packages:watch": "npm-run-all -p packages:watch:*",
    "packages:watch:shared": "cd packages/shared && npm run watch",
    "packages:watch:addon": "cd packages/storybook-addon-spfx && npm run watch",
    "packages:clean": "rm -rf packages/*/dist packages/*/temp",
    "packages:install": "cd packages/shared && npm install && cd ../storybook-addon-spfx && npm install",
    "clean": "rm -rf dist temp && npm run packages:clean",
    "clean:full": "npm run clean && rm -rf node_modules packages/*/node_modules",
    "install": "npm install && npm run packages:install"
  },
  "dependencies": {
    "@spfx-local-workbench/shared": "file:./packages/shared"
  },
  "devDependencies": {
    "@fluentui/react": "^8.110.10",
    "@types/node": "22.x",
    "@types/react": "^17.0.0",
    "@types/react-dom": "^17.0.0",
    "@types/vscode": "^1.100.0",
    "esbuild": "^0.27.2",
    "eslint": "^9.39.2",
    "npm-run-all": "^4.1.5",
    "react": "17.0.2",
    "react-dom": "17.0.2",
    "subset-font": "^1.4.10",
    "typed-css-modules": "^0.9.1",
    "typescript": "^5.9.3",
    "typescript-eslint": "^8.54.0"
  }
}
